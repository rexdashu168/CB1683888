<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rexå¤§å”168 CBç³»çµ± v6.1</title>
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Microsoft JhengHei', sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; }
        .rex-home { max-width: 800px; margin: 0 auto; min-height: 100vh; display: flex; flex-direction: column; }
        .rex-header { background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%); padding: 40px 20px 30px; text-align: center; color: white; }
        .rex-logo { font-size: 4em; margin-bottom: 15px; }
        .rex-title { font-size: 1.8em; font-weight: 700; margin-bottom: 10px; }
        .rex-subtitle { font-size: 1em; opacity: 0.95; margin-bottom: 15px; }
        .rex-badge { display: inline-block; background: rgba(255,255,255,0.2); padding: 8px 20px; border-radius: 20px; }
        .stats-container { background: white; margin: 0 20px 20px; border-radius: 15px; padding: 20px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
        .stats-title { font-size: 1.2em; font-weight: 600; color: #1e3c72; margin-bottom: 15px; padding-bottom: 10px; border-bottom: 3px solid #667eea; }
        .stats-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; }
        .stat-item { background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%); padding: 12px 8px; border-radius: 10px; display: flex; flex-direction: column; align-items: center; text-align: center; gap: 8px; }
        .stat-icon { font-size: 1.8em; }
        .stat-info { width: 100%; }
        .stat-label { font-size: 0.75em; color: #666; margin-bottom: 5px; }
        .stat-value { font-size: 1.3em; font-weight: 700; color: #667eea; }
        .search-area { padding: 0 20px 20px; }
        .search-card { background: white; border-radius: 15px; padding: 25px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
        .search-card-title { font-size: 1.2em; font-weight: 600; color: #1e3c72; margin-bottom: 15px; padding-bottom: 10px; border-bottom: 3px solid #667eea; }
        .search-input-group { position: relative; margin-bottom: 15px; }
        .search-input { width: 100%; padding: 15px 60px 15px 15px; border: 2px solid #e0e0e0; border-radius: 12px; font-size: 1.05em; }
        .search-input:focus { outline: none; border-color: #667eea; box-shadow: 0 0 0 3px rgba(102,126,234,0.1); }
        .search-btn { position: absolute; right: 8px; top: 50%; transform: translateY(-50%); background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; padding: 10px 20px; border-radius: 8px; font-weight: 600; cursor: pointer; }
        .search-hint { font-size: 0.85em; color: #999; margin-bottom: 15px; }
        .quick-examples { background: #f8f9fa; padding: 15px; border-radius: 10px; }
        .quick-title { font-size: 0.9em; font-weight: 600; color: #555; margin-bottom: 10px; }
        .chip-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 8px; }
        .chip { background: white; padding: 10px; border-radius: 8px; cursor: pointer; border: 1px solid #e0e0e0; transition: all 0.3s; text-align: center; font-size: 0.9em; }
        .chip:hover { background: #667eea; color: white; transform: translateY(-2px); }
        .chip-label { font-size: 0.75em; color: #999; display: block; }
        .chip:hover .chip-label { color: rgba(255,255,255,0.8); }
        .rex-footer { margin-top: auto; padding: 30px 20px; text-align: center; color: white; opacity: 0.9; }
        
        .detail-screen { display: none; max-width: 800px; margin: 0 auto; background: #f5f5f5; min-height: 100vh; overflow-y: auto; }
        .detail-screen.active { display: block; position: relative; }
        .detail-header { background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%); color: white; padding: 20px; position: sticky; top: 0; z-index: 100; }
        .detail-back { background: rgba(255,255,255,0.2); border: none; color: white; padding: 8px 15px; border-radius: 8px; cursor: pointer; margin-bottom: 15px; }
        .detail-title-area { display: flex; justify-content: space-between; align-items: center; }
        .detail-main-title { font-size: 1.6em; font-weight: 700; }
        .detail-subtitle { font-size: 0.9em; opacity: 0.9; margin-top: 5px; }
        .detail-price { font-size: 1.8em; font-weight: 700; }
        .detail-content { padding: 15px; }
        .tab-nav { background: white; display: flex; border-radius: 12px; margin-bottom: 15px; overflow-x: auto; }
        .tab-btn { flex: 1; min-width: 80px; padding: 15px 10px; border: none; background: white; font-weight: 600; cursor: pointer; color: #666; font-size: 0.9em; white-space: nowrap; }
        .tab-btn.active { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        .info-card { background: white; border-radius: 12px; padding: 20px; margin-bottom: 15px; }
        .card-title { font-size: 1.2em; font-weight: 600; color: #1e3c72; margin-bottom: 15px; padding-bottom: 10px; border-bottom: 3px solid #667eea; }
        .info-row { display: flex; padding: 12px 0; border-bottom: 1px solid #f0f0f0; }
        .info-row:last-child { border-bottom: none; }
        .info-label { flex: 0 0 120px; font-weight: 600; color: #555; font-size: 0.95em; }
        .info-value { flex: 1; color: #333; font-size: 0.95em; }
        .highlight-green { color: #52c41a; font-weight: 600; }
        .highlight-blue { color: #1890ff; font-weight: 600; }
        .highlight-orange { color: #ff9800; font-weight: 600; }
        
        .loading-status {
            background: #fff3cd;
            padding: 12px;
            border-radius: 8px;
            margin: 15px 0;
            font-size: 0.9em;
            color: #856404;
        }
        
        @media (max-width: 768px) {
            .stats-grid { grid-template-columns: repeat(4, 1fr); gap: 8px; }
            .stat-item { padding: 10px 5px; }
            .stat-icon { font-size: 1.5em; }
            .stat-label { font-size: 0.65em; }
            .stat-value { font-size: 1.1em; }
            .chip-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <div id="home" class="rex-home">
        <div class="rex-header">
            <div class="rex-logo">ğŸ“ˆ</div>
            <h1 class="rex-title">Rexå¤§å”168<br>CBæ™ºèƒ½æŸ¥è©¢ç³»çµ±</h1>
            <p class="rex-subtitle">å°ˆæ³¨é¢¨éšª â€¢ æ•¸æ“šé©…å‹• â€¢ æ™ºèƒ½åˆ†æ<br>æ•´åˆ13å¹´+æ­·å² â€¢ å®Œæ•´è³‡æ–™åº«</p>
            <div class="rex-badge">ğŸ¯ v6.1 è‡ªå‹•è¼‰å…¥ç‰ˆ</div>
        </div>
        
        <div class="stats-container">
            <div class="stats-title">ğŸ“Š è³‡æ–™åº«çµ±è¨ˆ</div>
            <div id="loadingStatus" class="loading-status">æ­£åœ¨è¼‰å…¥è³‡æ–™...</div>
            <div class="stats-grid">
                <div class="stat-item">
                    <div class="stat-icon">ğŸ“Š</div>
                    <div class="stat-info">
                        <div class="stat-label">CBè³‡æ–™</div>
                        <div class="stat-value" id="cbCount">0æª”</div>
                    </div>
                </div>
                <div class="stat-item">
                    <div class="stat-icon">ğŸ“°</div>
                    <div class="stat-info">
                        <div class="stat-label">å¤–é›»å ±å°</div>
                        <div class="stat-value" id="newsCount">0å‰‡</div>
                    </div>
                </div>
                <div class="stat-item">
                    <div class="stat-icon">ğŸ“ˆ</div>
                    <div class="stat-info">
                        <div class="stat-label">ç ”ç©¶å ±å‘Š</div>
                        <div class="stat-value" id="reportCount">0ç¯‡</div>
                    </div>
                </div>
                <div class="stat-item">
                    <div class="stat-icon">ğŸ­</div>
                    <div class="stat-info">
                        <div class="stat-label">æ¦‚å¿µè‚¡</div>
                        <div class="stat-value" id="conceptCount">0æª”</div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="search-area">
            <div class="search-card">
                <div class="search-card-title">ğŸ” æ™ºèƒ½æœå°‹</div>
                <div class="search-input-group">
                    <input type="text" class="search-input" id="cbInput" 
                           placeholder="è¼¸å…¥CBä»£è™Ÿã€è‚¡ç¥¨ä»£è™Ÿæˆ–å…¬å¸åç¨±..." 
                           onkeypress="if(event.key==='Enter') smartSearch()">
                    <button class="search-btn" onclick="smartSearch()">æœå°‹</button>
                </div>
                <div class="search-hint">ğŸ’¡ æ”¯æ´: 11011 / 1101 / å°æ³¥</div>
                <div class="quick-examples">
                    <div class="quick-title">âš¡ å¿«é€Ÿæ¸¬è©¦</div>
                    <div class="chip-grid">
                        <div class="chip" onclick="quickSearch('11011')">
                            <strong>11011</strong><br>
                            <span class="chip-label">å°æ³¥ä¸€æ°¸(è©¢åœˆ)</span>
                        </div>
                        <div class="chip" onclick="quickSearch('12101')">
                            <strong>12101</strong><br>
                            <span class="chip-label">å¤§æˆä¸€(è©¢åœˆ)</span>
                        </div>
                        <div class="chip" onclick="quickSearch('13166')">
                            <strong>13166</strong><br>
                            <span class="chip-label">ä¸Šæ›œå…­(ç«¶æ‹)</span>
                        </div>
                        <div class="chip" onclick="quickSearch('13411')">
                            <strong>13411</strong><br>
                            <span class="chip-label">å¯Œæ—ä¸€K(ç«¶æ‹)</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="rex-footer">
            <strong>Rexå¤§å”çš„æŠ•è³‡ç†å¿µ</strong><br>
            <small style="margin-top:10px;display:block;">å°ˆæ³¨æ–¼é¢¨éšª,ä¸è¿½æ±‚å ±é…¬<br>å¾æ•¸æ“šä¸­å­¸ç¿’,ç”¨æ™ºæ…§æŠ•è³‡</small>
            <small style="margin-top:15px;display:block;opacity:0.8;">Â© 2025 Rexå¤§å”168 â€¢ v6.1</small>
        </div>
    </div>
    
    <div id="detail" class="detail-screen">
        <div class="detail-header">
            <button class="detail-back" onclick="backToHome()">â† è¿”å›</button>
            <div class="detail-title-area">
                <div>
                    <div class="detail-main-title" id="detailTitle">è¼‰å…¥ä¸­...</div>
                    <div class="detail-subtitle" id="detailSubtitle">...</div>
                </div>
                <div class="detail-price" id="detailPrice">--</div>
            </div>
        </div>
        <div class="detail-content">
            <div class="tab-nav">
                <button class="tab-btn active" onclick="switchTab('basic')">åŸºæœ¬è³‡æ–™</button>
                <button class="tab-btn" onclick="switchTab('auction')">ç«¶æ‹è³‡è¨Š</button>
                <button class="tab-btn" onclick="switchTab('news')">å¤–é›»å ±å°</button>
                <button class="tab-btn" onclick="switchTab('reports')">ç ”ç©¶å ±å‘Š</button>
            </div>
            <div id="tab-basic" class="tab-content active">
                <div id="basicContent"></div>
            </div>
            <div id="tab-auction" class="tab-content">
                <div id="auctionContent"></div>
            </div>
            <div id="tab-news" class="tab-content">
                <div id="newsContent"></div>
            </div>
            <div id="tab-reports" class="tab-content">
                <div id="reportsContent"></div>
            </div>
        </div>
    </div>

    <script>
    // å…¨åŸŸè®Šæ•¸
    let highLowData = {};
    let cbDatabase = {};
    let auctionData = {};
    let foreignNewsData = [];
    let stockReportsData = [];
    let conceptData = {};
    let industryData = {};
    let currentCB = null;

    // è‡ªå‹•è¼‰å…¥Excelæª”æ¡ˆ
    async function loadExcelFiles() {
        const files = [
            '00_CBä»£è™Ÿåç¨±.xlsx',
            '01_cb168report.xlsx',
            '02_CBASæœˆæ‹†è§£è¡¨.xlsx',
            '04_CBæœˆæˆäº¤åƒ¹è¡¨.xlsx'
        ];
        
        let loadedCount = 0;
        
        for (const fileName of files) {
            try {
                const response = await fetch(fileName);
                if (!response.ok) continue;
                
                const arrayBuffer = await response.arrayBuffer();
                const workbook = XLSX.read(new Uint8Array(arrayBuffer), { type: 'array' });
                
                // è™•ç†ä¸åŒæª”æ¡ˆ
                if (fileName.includes('00_CB')) {
                    process00File(workbook);
                    loadedCount++;
                } else if (fileName.includes('01_cb168report')) {
                    processReportFile(workbook);
                    loadedCount++;
                } else if (fileName.includes('02_CBAS')) {
                    loadedCount++;
                } else if (fileName.includes('04_CB')) {
                    loadedCount++;
                }
                
            } catch (error) {
                console.log(`ç„¡æ³•è¼‰å…¥ ${fileName}:`, error.message);
            }
        }
        
        updateLoadingStatus(loadedCount);
        updateStats();
    }

    // æ›´æ–°è¼‰å…¥ç‹€æ…‹
    function updateLoadingStatus(count) {
        const status = document.getElementById('loadingStatus');
        if (count === 0) {
            status.innerHTML = 'âš ï¸ æœªæ‰¾åˆ°Excelæª”æ¡ˆ,è«‹ç¢ºèªæª”æ¡ˆå·²ä¸Šå‚³åˆ°åŒä¸€ç›®éŒ„';
            status.style.background = '#f8d7da';
            status.style.color = '#721c24';
        } else if (count < 4) {
            status.innerHTML = `âœ… å·²è¼‰å…¥ ${count}/4 å€‹æª”æ¡ˆ`;
            status.style.background = '#fff3cd';
        } else {
            status.innerHTML = 'âœ… æ‰€æœ‰è³‡æ–™è¼‰å…¥å®Œæˆ';
            status.style.background = '#d4edda';
            status.style.color = '#155724';
        }
    }

    // è™•ç†00æª”æ¡ˆ
    function process00File(workbook) {
        // è™•ç†00å·¥ä½œè¡¨ - æ›ç‰Œé«˜ä½
        if (workbook.SheetNames.includes('00')) {
            const sheet = workbook.Sheets['00'];
            const jsonData = XLSX.utils.sheet_to_json(sheet);
            
            jsonData.forEach(row => {
                const cbCode = String(row['CBä»£è™Ÿ'] || '').trim();
                if (cbCode) {
                    highLowData[cbCode] = {
                        name: row['CBåç¨±'] || '',
                        high: parseFloat(row['æ›ç‰Œæœ€é«˜'] || 0),
                        low: parseFloat(row['æ›ç‰Œæœ€ä½'] || 0),
                        avgBid: parseFloat(row['å¹³å‡å¾—æ¨™'] || 100),
                        method: row['ç™¼è¡Œæ–¹å¼'] || '',
                        security: row['æ“”ä¿'] || ''
                    };
                }
            });
            console.log('è¼‰å…¥æ›ç‰Œé«˜ä½è³‡æ–™:', Object.keys(highLowData).length);
        }
        
        // è™•ç†01å·¥ä½œè¡¨ - åŸºæœ¬è³‡æ–™
        if (workbook.SheetNames.includes('01')) {
            const sheet = workbook.Sheets['01'];
            const jsonData = XLSX.utils.sheet_to_json(sheet);
            
            jsonData.forEach(row => {
                const cbCode = String(row['CBä»£è™Ÿ'] || '').trim();
                if (cbCode) {
                    cbDatabase[cbCode] = row;
                }
            });
            console.log('è¼‰å…¥åŸºæœ¬è³‡æ–™:', Object.keys(cbDatabase).length);
        }
        
        // è™•ç†04å·¥ä½œè¡¨ - ç«¶æ‹è³‡æ–™
        if (workbook.SheetNames.includes('04')) {
            const sheet = workbook.Sheets['04'];
            const jsonData = XLSX.utils.sheet_to_json(sheet);
            
            jsonData.forEach(row => {
                const cbCode = String(row['CBä»£è™Ÿ'] || '').trim();
                if (cbCode) {
                    auctionData[cbCode] = row;
                }
            });
            console.log('è¼‰å…¥ç«¶æ‹è³‡æ–™:', Object.keys(auctionData).length);
        }
    }

    // è™•ç†ç ”ç©¶å ±å‘Šæª”æ¡ˆ
    function processReportFile(workbook) {
        // å¤–é›»å ±å°
        if (workbook.SheetNames.includes('å¤–é›»ç¶œåˆå ±å°')) {
            const sheet = workbook.Sheets['å¤–é›»ç¶œåˆå ±å°'];
            foreignNewsData = XLSX.utils.sheet_to_json(sheet);
            console.log('è¼‰å…¥å¤–é›»å ±å°:', foreignNewsData.length);
        }
        
        // å€‹è‚¡ç ”ç©¶å ±å‘Š
        if (workbook.SheetNames.includes('è©³ç´°å…§å®¹åº«')) {
            const sheet = workbook.Sheets['è©³ç´°å…§å®¹åº«'];
            stockReportsData = XLSX.utils.sheet_to_json(sheet);
            console.log('è¼‰å…¥å€‹è‚¡å ±å‘Š:', stockReportsData.length);
        }
        
        // æ¦‚å¿µè‚¡
        if (workbook.SheetNames.includes('æ¦‚å¿µè‚¡æ—ç¾¤è³‡æ–™åº«')) {
            const sheet = workbook.Sheets['æ¦‚å¿µè‚¡æ—ç¾¤è³‡æ–™åº«'];
            const jsonData = XLSX.utils.sheet_to_json(sheet);
            
            jsonData.forEach(row => {
                const code = String(row['è‚¡ç¥¨ä»£è™Ÿ'] || '').trim();
                if (code) {
                    if (!conceptData[code]) conceptData[code] = [];
                    conceptData[code].push(row);
                }
            });
            console.log('è¼‰å…¥æ¦‚å¿µè‚¡:', Object.keys(conceptData).length);
        }
        
        // ç”¢æ¥­åˆ†é¡
        if (workbook.SheetNames.includes('ç”¢æ¥­åˆ†é¡')) {
            const sheet = workbook.Sheets['ç”¢æ¥­åˆ†é¡'];
            const jsonData = XLSX.utils.sheet_to_json(sheet);
            
            jsonData.forEach(row => {
                const code = String(row['ä»£è™Ÿ'] || '').trim();
                if (code) {
                    industryData[code] = row;
                }
            });
            console.log('è¼‰å…¥ç”¢æ¥­åˆ†é¡:', Object.keys(industryData).length);
        }
    }

    // æ›´æ–°çµ±è¨ˆ
    function updateStats() {
        document.getElementById('cbCount').textContent = Object.keys(highLowData).length + 'æª”';
        document.getElementById('newsCount').textContent = foreignNewsData.length + 'å‰‡';
        document.getElementById('reportCount').textContent = stockReportsData.length + 'ç¯‡';
        document.getElementById('conceptCount').textContent = Object.keys(conceptData).length + 'æª”';
    }

    // æ™ºèƒ½æœå°‹
    function smartSearch() {
        const input = document.getElementById('cbInput').value.trim();
        if (!input) {
            alert('è«‹è¼¸å…¥æŸ¥è©¢æ¢ä»¶');
            return;
        }
        
        if (Object.keys(highLowData).length === 0 && Object.keys(cbDatabase).length === 0) {
            alert('è³‡æ–™å°šæœªè¼‰å…¥å®Œæˆ,è«‹ç¨å¾Œå†è©¦');
            return;
        }
        
        // å°‹æ‰¾CB
        let found = null;
        
        // CBä»£è™ŸæŸ¥è©¢
        if (highLowData[input]) {
            found = input;
        } else if (cbDatabase[input]) {
            found = input;
        } else {
            // è‚¡ç¥¨ä»£è™ŸæŸ¥è©¢
            for (let code in cbDatabase) {
                if (cbDatabase[code]['è‚¡ç¥¨ä»£è™Ÿ'] === input) {
                    found = code;
                    break;
                }
            }
            
            // åç¨±æŸ¥è©¢
            if (!found) {
                for (let code in highLowData) {
                    if (highLowData[code].name && highLowData[code].name.includes(input)) {
                        found = code;
                        break;
                    }
                }
            }
        }
        
        if (found) {
            loadCBDetail(found);
        } else {
            alert('æŸ¥ç„¡è³‡æ–™');
        }
    }

    function quickSearch(code) {
        document.getElementById('cbInput').value = code;
        smartSearch();
    }

    function backToHome() {
        document.getElementById('home').style.display = 'flex';
        document.getElementById('detail').classList.remove('active');
        window.scrollTo({ top: 0, behavior: 'instant' });
    }

    function loadCBDetail(cbCode) {
        currentCB = cbCode;
        const cb = highLowData[cbCode] || {};
        const cbInfo = cbDatabase[cbCode] || {};
        
        document.getElementById('detailTitle').textContent = cb.name || cbCode;
        document.getElementById('detailSubtitle').textContent = `CBä»£è™Ÿ: ${cbCode}`;
        document.getElementById('detailPrice').textContent = cb.avgBid ? cb.avgBid.toFixed(2) : '--';
        
        // åŸºæœ¬è³‡æ–™
        let html = `
        <div class="info-card">
            <div class="card-title">ğŸ“‹ åŸºæœ¬è³‡è¨Š</div>
            <div class="info-row">
                <div class="info-label">CBä»£è™Ÿ</div>
                <div class="info-value"><span class="highlight-blue">${cbCode}</span></div>
            </div>
            <div class="info-row">
                <div class="info-label">CBåç¨±</div>
                <div class="info-value">${cb.name || '--'}</div>
            </div>
            <div class="info-row">
                <div class="info-label">æ›ç‰Œæœ€é«˜</div>
                <div class="info-value"><span class="highlight-green">${cb.high ? cb.high.toFixed(2) : '--'}</span></div>
            </div>
            <div class="info-row">
                <div class="info-label">æ›ç‰Œæœ€ä½</div>
                <div class="info-value"><span class="highlight-orange">${cb.low ? cb.low.toFixed(2) : '--'}</span></div>
            </div>
            <div class="info-row">
                <div class="info-label">ç™¼è¡Œæ–¹å¼</div>
                <div class="info-value">${cb.method || '--'}</div>
            </div>
            <div class="info-row">
                <div class="info-label">æ“”ä¿æƒ…å½¢</div>
                <div class="info-value">${cb.security || '--'}</div>
            </div>
        </div>`;
        
        document.getElementById('basicContent').innerHTML = html;
        
        // ç«¶æ‹è³‡è¨Š
        loadAuctionInfo(cbCode);
        
        // å¤–é›»å ±å°
        loadNewsForCB(cbCode);
        
        // ç ”ç©¶å ±å‘Š
        loadReportsForCB(cbCode);
        
        document.getElementById('home').style.display = 'none';
        document.getElementById('detail').classList.add('active');
        window.scrollTo({ top: 0, behavior: 'instant' });
    }

    function loadAuctionInfo(cbCode) {
        const auction = auctionData[cbCode];
        let html = '';
        
        if (auction) {
            html = `
            <div class="info-card">
                <div class="card-title">ğŸ”¨ ç«¶æ‹è³‡è¨Š</div>
                <div class="info-row">
                    <div class="info-label">ç†è«–åƒ¹æ ¼</div>
                    <div class="info-value">${auction['ç†è«–åƒ¹æ ¼'] || '--'}</div>
                </div>
                <div class="info-row">
                    <div class="info-label">å¹³å‡å¾—æ¨™</div>
                    <div class="info-value">${auction['å¹³å‡å¾—æ¨™'] || '--'}</div>
                </div>
                <div class="info-row">
                    <div class="info-label">æŠ•æ¨™å€æ•¸</div>
                    <div class="info-value">${auction['æŠ•æ¨™å€æ•¸'] || '--'}</div>
                </div>
            </div>`;
        } else {
            html = '<div class="info-card"><div class="card-title">ğŸ”¨ ç«¶æ‹è³‡è¨Š</div><p style="padding:20px;text-align:center;color:#999;">ç„¡ç«¶æ‹è³‡æ–™</p></div>';
        }
        
        document.getElementById('auctionContent').innerHTML = html;
    }

    function loadNewsForCB(cbCode) {
        const stockCode = cbDatabase[cbCode]?.['è‚¡ç¥¨ä»£è™Ÿ'];
        const relatedNews = foreignNewsData.filter(n => n['è‚¡è™Ÿ'] === stockCode);
        
        let html = '';
        if (relatedNews.length > 0) {
            relatedNews.slice(0, 5).forEach(news => {
                html += `
                <div class="info-card">
                    <div class="card-title">${news['å…¬å¸'] || ''} - ${news['æ—¥æœŸ'] || ''}</div>
                    <div style="padding:10px 0;line-height:1.6;">${news['å®Œæ•´å ±å°å…§å®¹'] || ''}</div>
                    <div style="font-size:0.85em;color:#999;">ä¾†æº: ${news['åˆ¸å•†ä¾†æº'] || ''}</div>
                </div>`;
            });
        } else {
            html = '<div class="info-card"><div class="card-title">ğŸ“° å¤–é›»å ±å°</div><p style="padding:20px;text-align:center;color:#999;">ç„¡ç›¸é—œå ±å°</p></div>';
        }
        
        document.getElementById('newsContent').innerHTML = html;
    }

    function loadReportsForCB(cbCode) {
        const stockCode = cbDatabase[cbCode]?.['è‚¡ç¥¨ä»£è™Ÿ'];
        const relatedReports = stockReportsData.filter(r => r['è‚¡è™Ÿ'] === stockCode);
        
        let html = '';
        if (relatedReports.length > 0) {
            relatedReports.forEach(report => {
                html += `
                <div class="info-card">
                    <div class="card-title">${report['å…¬å¸'] || ''} - ${report['å ±å‘Šæ—¥æœŸ'] || ''}</div>
                    <div class="info-row">
                        <div class="info-label">åˆ¸å•†</div>
                        <div class="info-value">${report['åˆ¸å•†'] || '--'}</div>
                    </div>
                    <div class="info-row">
                        <div class="info-label">æŠ•è³‡è©•ç­‰</div>
                        <div class="info-value">${report['æŠ•è³‡è©•ç­‰'] || '--'}</div>
                    </div>
                    <div class="info-row">
                        <div class="info-label">ç›®æ¨™åƒ¹</div>
                        <div class="info-value">${report['ç›®æ¨™åƒ¹'] || '--'}</div>
                    </div>
                    <div style="padding:10px 0;line-height:1.6;">${report['ç²¾ç°¡é‡é»æ‘˜è¦'] || ''}</div>
                </div>`;
            });
        } else {
            html = '<div class="info-card"><div class="card-title">ğŸ“ˆ ç ”ç©¶å ±å‘Š</div><p style="padding:20px;text-align:center;color:#999;">ç„¡ç›¸é—œå ±å‘Š</p></div>';
        }
        
        document.getElementById('reportsContent').innerHTML = html;
    }

    function switchTab(tabName) {
        document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
        document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
        
        event.target.classList.add('active');
        document.getElementById(`tab-${tabName}`).classList.add('active');
    }

    // é é¢è¼‰å…¥æ™‚è‡ªå‹•è®€å–Excel
    window.addEventListener('DOMContentLoaded', function() {
        loadExcelFiles();
    });
    </script>
</body>
</html>




