<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Rexå¤§å” æ™ºèƒ½CBæˆ°æƒ…å®¤ (è‡ªå‹•åŒæ­¥ç‰ˆ)</title>
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <style>
        :root { --primary: #1a73e8; --bg: #f8f9fa; --card-bg: #ffffff; --text: #333; }
        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { font-family: -apple-system, BlinkMacSystemFont, "Microsoft JhengHei", sans-serif; background: var(--bg); color: var(--text); padding-bottom: 60px; }
        
        /* é ‚éƒ¨å°èˆª */
        .header { background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%); color: white; padding: 15px; position: sticky; top: 0; z-index: 100; box-shadow: 0 2px 10px rgba(0,0,0,0.1); display: flex; justify-content: space-between; align-items: center; }
        .header h1 { font-size: 18px; margin: 0; font-weight: 600; }
        .status-pill { font-size: 12px; background: rgba(255,255,255,0.2); padding: 4px 12px; border-radius: 20px; }
        
        /* æœå°‹å€ */
        .search-box { padding: 15px; background: white; box-shadow: 0 1px 3px rgba(0,0,0,0.05); position: sticky; top: 55px; z-index: 90; }
        .input-group { display: flex; gap: 10px; }
        input { flex: 1; padding: 12px; border: 1px solid #ddd; border-radius: 8px; font-size: 16px; outline: none; transition: border 0.3s; }
        input:focus { border-color: var(--primary); }
        button { padding: 0 20px; background: var(--primary); color: white; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; }

        /* å…§å®¹å€ */
        .container { padding: 15px; max-width: 1000px; margin: 0 auto; }
        
        /* å¡ç‰‡è¨­è¨ˆ */
        .card { background: var(--card-bg); border-radius: 12px; padding: 15px; margin-bottom: 15px; box-shadow: 0 2px 8px rgba(0,0,0,0.05); transition: transform 0.2s; cursor: pointer; border: 1px solid transparent; }
        .card:hover { transform: translateY(-2px); border-color: var(--primary); }
        .card-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; border-bottom: 1px solid #eee; padding-bottom: 8px; }
        .cb-name { font-size: 18px; font-weight: bold; color: #2c3e50; }
        .cb-code { font-size: 14px; color: #7f8c8d; background: #f0f2f5; padding: 2px 8px; border-radius: 4px; }
        
        .grid-info { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; text-align: center; }
        .info-item small { display: block; color: #999; font-size: 12px; margin-bottom: 2px; }
        .info-item span { font-size: 15px; font-weight: 600; }
        .text-red { color: #e74c3c; }
        .text-green { color: #27ae60; }

        /* è¼‰å…¥ç•«é¢ */
        .loader { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(255,255,255,0.95); z-index: 2000; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        .spinner { width: 40px; height: 40px; border: 4px solid #f3f3f3; border-top: 4px solid var(--primary); border-radius: 50%; animation: spin 1s linear infinite; }
        .progress-text { margin-top: 15px; font-size: 14px; color: #666; }
        .progress-bar { width: 200px; height: 6px; background: #eee; margin-top: 10px; border-radius: 3px; overflow: hidden; }
        .progress-fill { height: 100%; background: var(--primary); width: 0%; transition: width 0.3s; }

        /* è©³æƒ… Modal */
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 3000; overflow-y: auto; padding: 20px 0; }
        .modal.show { display: flex; justify-content: center; align-items: flex-start; }
        .modal-content { background: white; width: 95%; max-width: 800px; border-radius: 12px; padding: 20px; position: relative; margin-bottom: 50px; animation: slideUp 0.3s; }
        .close-btn { position: absolute; top: 15px; right: 15px; font-size: 24px; cursor: pointer; color: #999; z-index: 10; }
        
        /* åœ–è¡¨å€ */
        .chart-box { height: 300px; margin: 20px 0; border: 1px solid #eee; border-radius: 8px; padding: 10px; }

        /* æ¨™ç±¤ */
        .tags { display: flex; gap: 5px; flex-wrap: wrap; margin-top: 8px; }
        .tag { font-size: 12px; padding: 3px 8px; border-radius: 4px; background: #e3f2fd; color: var(--primary); }
        .tag.auction { background: #fff3e0; color: #e67e22; }

        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        @keyframes slideUp { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
    </style>
</head>
<body>

    <div id="loader" class="loader">
        <div class="spinner"></div>
        <div class="progress-text" id="loadStatus">æ­£åœ¨é€£ç·šè‡³è³‡æ–™åº«...</div>
        <div class="progress-bar"><div class="progress-fill" id="progressFill"></div></div>
        <div style="font-size:12px; color:#999; margin-top:5px;">è«‹ç¨å€™ï¼Œæ­£åœ¨è§£æ 4 ä»½ Excel æª”æ¡ˆ</div>
    </div>

    <div class="header">
        <h1>Rexå¤§å” æ™ºèƒ½CBæˆ°æƒ…å®¤</h1>
        <div class="status-pill" id="dbCount">DB: åˆå§‹åŒ–ä¸­</div>
    </div>

    <div class="search-box">
        <div class="input-group">
            <input type="text" id="searchInput" placeholder="è¼¸å…¥ä»£è™Ÿ (å¦‚: 68732) æˆ–åç¨±..." onkeyup="if(event.key === 'Enter') doSearch()">
            <button onclick="doSearch()">æœå°‹</button>
        </div>
    </div>

    <div class="container" id="resultList">
        <div style="text-align:center; color:#999; margin-top: 50px;">
            <p>ğŸ‘† è«‹åœ¨ä¸Šæœå°‹åˆ—è¼¸å…¥é—œéµå­—</p>
            <p>è³‡æ–™ä¾†æº: GitHub è‡ªå‹•åŒæ­¥</p>
        </div>
    </div>

    <div id="detailModal" class="modal" onclick="if(event.target === this) closeModal()">
        <div class="modal-content">
            <span class="close-btn" onclick="closeModal()">&times;</span>
            <div id="modalBody"></div>
        </div>
    </div>

<script>
// å…¨åŸŸè³‡æ–™å„²å­˜
const DB = {
    basic: {},     // 00_CB.xlsx (åŸºæœ¬è³‡æ–™)
    auction: {},   // 00_CB.xlsx (ç«¶æ‹)
    reports: {},   // 01_Report.xlsx (å ±å‘Š)
    news: [],      // 01_Report.xlsx (æ–°è)
    cbas: {},      // 02_CBAS.xlsx (æ‹†è§£è¡¨)
    prices: {},    // 04_Price.xlsx (æœˆæˆäº¤åƒ¹ - æ­·å²èµ°å‹¢)
    industry: {}   // 00_CB.xlsx (ç”¢æ¥­)
};

// æª”æ¡ˆå®šç¾© (å¿…é ˆèˆ‡ GitHub ä¸Šæª”åä¸€è‡´)
const FILES = [
    { id: '00', name: '00_CB.xlsx', desc: 'åŸºæœ¬è³‡æ–™åº«' },
    { id: '01', name: '01_Report.xlsx', desc: 'ç ”ç©¶å ±å‘Š' },
    { id: '02', name: '02_CBAS.xlsx', desc: 'CBAS æ•¸æ“š' },
    { id: '04', name: '04_Price.xlsx', desc: 'æ­·å²è¡Œæƒ…' }
];

// åˆå§‹åŒ–
window.onload = async function() {
    await loadAllFiles();
};

async function loadAllFiles() {
    let loaded = 0;
    const statusEl = document.getElementById('loadStatus');
    const fillEl = document.getElementById('progressFill');

    for (let file of FILES) {
        try {
            statusEl.innerText = `ä¸‹è¼‰ä¸­: ${file.desc}...`;
            const response = await fetch(file.name);
            
            if (!response.ok) throw new Error(`HTTP ${response.status}`);
            
            const buffer = await response.arrayBuffer();
            statusEl.innerText = `è§£æä¸­: ${file.desc}...`;
            
            const workbook = XLSX.read(buffer, { type: 'array' });
            processData(file.id, workbook);
            
            loaded++;
            fillEl.style.width = `${(loaded / FILES.length) * 100}%`;
            
        } catch (error) {
            console.warn(`ç„¡æ³•è¼‰å…¥ ${file.name}:`, error);
            statusEl.innerHTML += `<br><span style="color:red">âŒ ${file.name} è®€å–å¤±æ•—</span>`;
        }
    }

    // å®Œæˆ
    setTimeout(() => {
        document.getElementById('loader').style.display = 'none';
        document.getElementById('dbCount').innerText = `DB: ${Object.keys(DB.basic).length} æª”`;
        // è‡ªå‹•é¡¯ç¤ºä¸€æª”ç¯„ä¾‹ (å¦‚æœæœ‰è³‡æ–™)
        const firstKey = Object.keys(DB.basic)[0];
        if(firstKey) renderCard(firstKey); 
    }, 500);
}

// è³‡æ–™è™•ç†æ ¸å¿ƒ
function processData(id, workbook) {
    const sheetNames = workbook.SheetNames;

    if (id === '00') {
        // è™•ç†åŸºæœ¬è³‡æ–™ (Sheet: 01_ALLCBåŸºæœ¬è³‡æ–™)
        // é€™è£¡åšä¸€å€‹æ¨¡ç³ŠåŒ¹é…ï¼Œå› ç‚º sheet åç¨±å¯èƒ½æœƒè®Š
        const basicSheet = workbook.Sheets['01_ALLCBåŸºæœ¬è³‡æ–™'] || workbook.Sheets[sheetNames[0]];
        const basicJson = XLSX.utils.sheet_to_json(basicSheet);
        basicJson.forEach(row => {
            // å˜—è©¦å¤šç¨®æ¬„ä½åç¨±
            const code = String(row['CBä»£è™Ÿ'] || row['ä»£è™Ÿ'] || '').trim();
            if (code) {
                DB.basic[code] = row;
                // å»ºç«‹ç”¢æ¥­å°æ‡‰
                if(row['è‚¡ç¥¨ä»£è™Ÿ'] && row['ç”¢æ¥­åˆ†é¡']) {
                    DB.industry[String(row['è‚¡ç¥¨ä»£è™Ÿ'])] = row['ç”¢æ¥­åˆ†é¡'];
                }
            }
        });

        // è™•ç†ç«¶æ‹è³‡æ–™
        const aucSheet = workbook.Sheets['04_æ‰€æœ‰CBç«¶æ‹è³‡æ–™åº«'];
        if(aucSheet) {
            const aucJson = XLSX.utils.sheet_to_json(aucSheet);
            aucJson.forEach(row => {
                const code = String(row['CBä»£è™Ÿ']).trim();
                if(code) DB.auction[code] = row;
            });
        }

    } else if (id === '01') {
        // è™•ç†æ–°èèˆ‡å ±å‘Š
        const newsSheet = workbook.Sheets['å¤–é›»ç¶œåˆå ±å°'];
        if(newsSheet) DB.news = XLSX.utils.sheet_to_json(newsSheet);

        const reportSheet = workbook.Sheets['è©³ç´°å…§å®¹åº«'];
        if(reportSheet) {
            const reports = XLSX.utils.sheet_to_json(reportSheet);
            reports.forEach(r => {
                const stockCode = String(r['è‚¡è™Ÿ'] || '').trim();
                if(stockCode) {
                    if(!DB.reports[stockCode]) DB.reports[stockCode] = [];
                    DB.reports[stockCode].push(r);
                }
            });
        }

    } else if (id === '02') {
        // è™•ç† CBAS (å–æœ€æ–°çš„ Sheet)
        const sheet = workbook.Sheets[sheetNames[0]]; 
        const json = XLSX.utils.sheet_to_json(sheet);
        json.forEach(row => {
            const code = String(row['CBä»£è™Ÿ'] || row['ä»£è™Ÿ'] || '').trim();
            if(code) DB.cbas[code] = row;
        });

    } else if (id === '04') {
        // è™•ç†æ­·å²åƒ¹æ ¼ (é—œéµåŠŸèƒ½: è®€å–æ‰€æœ‰æœˆä»½ Sheet)
        // Sheet åç¨±é€šå¸¸æ˜¯ 11201, 11202 (æ°‘åœ‹å¹´)
        sheetNames.forEach(sheetName => {
            // æª¢æŸ¥æ˜¯å¦ç‚ºæ•¸å­— (æ’é™¤ 'CBä»£è™Ÿ' ç­‰èªªæ˜é )
            if (!isNaN(parseInt(sheetName))) {
                const sheet = workbook.Sheets[sheetName];
                const json = XLSX.utils.sheet_to_json(sheet);
                
                // è½‰æ›æ°‘åœ‹å¹´ç‚ºè¥¿å…ƒå­—ä¸² (11201 -> 2023-01)
                const year = parseInt(sheetName.substring(0, 3)) + 1911;
                const month = sheetName.substring(3);
                const dateStr = `${year}-${month}`;

                json.forEach(row => {
                    // æ¬„ä½å¯èƒ½æ˜¯ 'ä»£è™Ÿ' æˆ– 'CBä»£è™Ÿ'
                    const code = String(row['ä»£è™Ÿ'] || row['CBä»£è™Ÿ'] || '').trim();
                    if (code) {
                        if (!DB.prices[code]) DB.prices[code] = [];
                        // å„²å­˜åƒ¹æ ¼è³‡è¨Š
                        DB.prices[code].push({
                            date: dateStr,
                            price: parseFloat(row['å¹³å‡'] || row['å¹³å‡åƒ¹'] || 0),
                            high: parseFloat(row['æœ€é«˜'] || row['æœ€é«˜åƒ¹'] || 0),
                            low: parseFloat(row['æœ€ä½'] || row['æœ€ä½åƒ¹'] || 0),
                            vol: parseFloat(row['æˆäº¤é‡'] || 0)
                        });
                    }
                });
            }
        });
        
        // å°æ¯å€‹ CB çš„åƒ¹æ ¼æŒ‰æ—¥æœŸæ’åº
        for(let code in DB.prices) {
            DB.prices[code].sort((a, b) => a.date.localeCompare(b.date));
        }
    }
}

// æœå°‹é‚è¼¯
function doSearch() {
    const keyword = document.getElementById('searchInput').value.trim().toUpperCase();
    if (!keyword) return;

    const container = document.getElementById('resultList');
    container.innerHTML = ''; // æ¸…ç©º

    const matches = [];
    // æœå°‹åŸºæœ¬è³‡æ–™
    for (let code in DB.basic) {
        const item = DB.basic[code];
        const name = String(item['åç¨±'] || '');
        const stockCode = String(item['è‚¡ç¥¨ä»£è™Ÿ'] || '');
        
        if (code.includes(keyword) || name.includes(keyword) || stockCode === keyword) {
            matches.push(code);
        }
    }

    if (matches.length === 0) {
        container.innerHTML = '<div style="text-align:center; padding:20px;">æŸ¥ç„¡è³‡æ–™</div>';
        return;
    }

    matches.forEach(code => renderCard(code));
}

// æ¸²æŸ“åˆ—è¡¨å¡ç‰‡
function renderCard(code) {
    const item = DB.basic[code];
    const cbas = DB.cbas[code] || {};
    const auc = DB.auction[code] || {};
    
    // è¨ˆç®—æº¢åƒ¹ç‡
    const marketPrice = parseFloat(cbas['CBæ”¶ç›¤åƒ¹'] || 0);
    const convertPrice = parseFloat(item['è½‰æ›åƒ¹æ ¼'] || 0);
    const stockPrice = parseFloat(cbas['è‚¡åƒ¹'] || 0);
    let premium = 0;
    if(convertPrice > 0 && stockPrice > 0) {
        const parity = (stockPrice / convertPrice) * 100;
        premium = ((marketPrice - parity) / parity) * 100;
    }

    const card = document.createElement('div');
    card.className = 'card';
    card.onclick = () => showDetail(code);
    
    card.innerHTML = `
        <div class="card-header">
            <div>
                <div class="cb-name">${item['åç¨±']}</div>
                <span class="cb-code">${code}</span>
                <span class="cb-code">${item['è‚¡ç¥¨ä»£è™Ÿ']}</span>
            </div>
            <div style="text-align:right;">
                <div style="font-size:20px; font-weight:bold; color:${marketPrice >= 100 ? '#e74c3c':'#27ae60'}">
                    ${marketPrice || '--'}
                </div>
                <small style="color:#999">æ”¶ç›¤åƒ¹</small>
            </div>
        </div>
        <div class="grid-info">
            <div class="info-item">
                <small>è½‰æ›åƒ¹</small>
                <span>${item['è½‰æ›åƒ¹æ ¼']}</span>
            </div>
            <div class="info-item">
                <small>ç†è«–åƒ¹</small>
                <span>${auc['ç†è«–åƒ¹'] ? parseFloat(auc['ç†è«–åƒ¹']).toFixed(2) : '--'}</span>
            </div>
             <div class="info-item">
                <small>ç™¼è¡Œè¦æ¨¡</small>
                <span>${item['ç™¼è¡Œè¦æ¨¡']}å„„</span>
            </div>
        </div>
        <div class="tags">
            <span class="tag">${item['ç”¢æ¥­åˆ†é¡'] || 'N/A'}</span>
            ${auc['ç«¶æ‹å¼µæ•¸'] ? '<span class="tag auction">ç«¶æ‹</span>' : '<span class="tag">è©¢åœˆ</span>'}
            ${item['æœ‰ç„¡æ“”ä¿'] ? `<span class="tag">${item['æœ‰ç„¡æ“”ä¿']}</span>` : ''}
        </div>
    `;
    
    document.getElementById('resultList').appendChild(card);
}

// é¡¯ç¤ºè©³æƒ… (Modal)
function showDetail(code) {
    const item = DB.basic[code];
    const priceHistory = DB.prices[code] || [];
    const stockCode = String(item['è‚¡ç¥¨ä»£è™Ÿ']);
    
    // ç›¸é—œå ±å‘Š
    const relevantReports = DB.reports[stockCode] || [];
    const relevantNews = DB.news.filter(n => String(n['è‚¡è™Ÿ']) === stockCode);

    const modalBody = document.getElementById('modalBody');
    modalBody.innerHTML = `
        <h2 style="margin-bottom:5px">${item['åç¨±']} <small style="color:#666">${code}</small></h2>
        <p style="color:#666; margin-bottom:15px">
            ${item['ç”¢æ¥­åˆ†é¡']} | 
            åˆ°æœŸæ—¥: ${item['åˆ°æœŸæ—¥æœŸ']} | 
            è³£å›æ—¥: ${item['è³£å›æ—¥æœŸ1'] || '--'}
        </p>

        <div id="priceChart" class="chart-box"></div>
        
        <div style="display:grid; grid-template-columns: 1fr 1fr; gap:15px; margin-bottom:20px;">
            <div style="background:#f8f9fa; padding:10px; border-radius:8px;">
                <div style="font-weight:bold; margin-bottom:5px; border-bottom:1px solid #ddd; padding-bottom:5px;">ç™¼è¡Œè³‡è¨Š</div>
                <div style="font-size:14px; line-height:1.6;">
                    <div>ç™¼è¡Œç¸½é¡: ${item['ç™¼è¡Œè¦æ¨¡']} å„„</div>
                    <div>è½‰æ›åƒ¹æ ¼: ${item['è½‰æ›åƒ¹æ ¼']}</div>
                    <div>æ“”ä¿æƒ…å½¢: ${item['æœ‰ç„¡æ“”ä¿']}</div>
                    <div>ä¸»è¾¦åˆ¸å•†: ${item['æ‰¿éŠ·åˆ¸å•†'] || '--'}</div>
                </div>
            </div>
             <div style="background:#fff3e0; padding:10px; border-radius:8px;">
                <div style="font-weight:bold; margin-bottom:5px; border-bottom:1px solid #e67e22; padding-bottom:5px; color:#e67e22">æœ€æ–°å‹•æ…‹</div>
                <div style="font-size:14px; line-height:1.6;">
                    <div>CBASå ±åƒ¹: ${DB.cbas[code]?.['æ¬Šåˆ©é‡‘(ä½°å…ƒå ±åƒ¹)'] || '--'}</div>
                    <div>è‚¡åƒ¹: ${DB.cbas[code]?.['è‚¡åƒ¹'] || '--'}</div>
                    <div>æ³¢å‹•ç‡: ${DB.cbas[code]?.['è‚¡åƒ¹æ³¢å‹•ç‡240å¤©%'] || '--'}%</div>
                </div>
            </div>
        </div>

        <h3>ğŸ“‘ æ³•äººè§€é»èˆ‡æ–°è</h3>
        <div style="max-height: 200px; overflow-y:auto; border:1px solid #eee; padding:10px; border-radius:8px; margin-top:10px;">
            ${relevantReports.length === 0 && relevantNews.length === 0 ? '<div style="color:#999;text-align:center">æš«ç„¡ç›¸é—œå ±å‘Š</div>' : ''}
            
            ${relevantReports.map(r => `
                <div style="margin-bottom:10px; padding-bottom:10px; border-bottom:1px dashed #eee;">
                    <div style="font-size:12px; color:#999;">${r['å ±å‘Šæ—¥æœŸ']} | ${r['åˆ¸å•†']}</div>
                    <div style="font-weight:600;">${r['æŠ•è³‡è©•ç­‰']} (ç›®æ¨™åƒ¹:${r['ç›®æ¨™åƒ¹']})</div>
                    <div style="font-size:13px; color:#555; margin-top:2px;">${r['ç²¾ç°¡é‡é»æ‘˜è¦'] || ''}</div>
                </div>
            `).join('')}
            
             ${relevantNews.map(n => `
                <div style="margin-bottom:10px; padding-bottom:10px; border-bottom:1px dashed #eee;">
                    <div style="font-size:12px; color:#999;">${n['æ—¥æœŸ']} | å¤–é›»å ±å°</div>
                    <div style="font-size:13px; color:#555;">${n['å®Œæ•´å ±å°å…§å®¹'] ? n['å®Œæ•´å ±å°å…§å®¹'].substring(0,80)+'...' : ''}</div>
                </div>
            `).join('')}
        </div>
    `;

    document.getElementById('detailModal').classList.add('show');

    // ç¹ªè£½åœ–è¡¨ (å¦‚æœæœ‰æ­·å²æ•¸æ“š)
    if (priceHistory.length > 0) {
        drawChart(priceHistory);
    } else {
        document.getElementById('priceChart').innerHTML = '<div style="display:flex;align-items:center;justify-content:center;height:100%;color:#999;">ç„¡æ­·å²æˆäº¤è³‡æ–™</div>';
    }
}

function drawChart(data) {
    const chartDom = document.getElementById('priceChart');
    const myChart = echarts.init(chartDom);
    
    const dates = data.map(d => d.date);
    const prices = data.map(d => d.price); // å¹³å‡åƒ¹
    const highs = data.map(d => d.high);
    const lows = data.map(d => d.low);

    const option = {
        title: { text: 'æœˆæˆäº¤å‡åƒ¹èµ°å‹¢', left: 'center', textStyle: { fontSize: 14 } },
        tooltip: { trigger: 'axis' },
        grid: { left: '3%', right: '4%', bottom: '3%', containLabel: true },
        xAxis: { type: 'category', data: dates },
        yAxis: { type: 'value', scale: true }, // scale:true è®“Yè»¸ä¸å¾0é–‹å§‹
        series: [
            {
                name: 'å‡åƒ¹',
                type: 'line',
                data: prices,
                itemStyle: { color: '#e74c3c' },
                showSymbol: false,
                smooth: true,
                areaStyle: {
                    color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                        { offset: 0, color: 'rgba(231,76,60,0.5)' },
                        { offset: 1, color: 'rgba(231,76,60,0.0)' }
                    ])
                }
            }
        ]
    };
    myChart.setOption(option);
    
    // RWD è‡ªé©æ‡‰
    window.addEventListener('resize', function() {
        myChart.resize();
    });
}

function closeModal() {
    document.getElementById('detailModal').classList.remove('show');
}

</script>
</body>
</html>
