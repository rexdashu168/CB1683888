<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rexå¤§å”çš„168å°è‚¡æŠ•è³‡æ•™å®¤ - æ•¸æ“šå„€è¡¨æ¿</title>
    
    <script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>

    <style>
        /* --- CSS æ¨£å¼å€ --- */
        :root {
            --primary-color: #1a202c; /* æ·±è‰²èƒŒæ™¯ */
            --accent-color: #d69e2e;  /* é‡‘è‰²/é»ƒè‰² (Rexå¤§å”é¢¨æ ¼) */
            --text-color: #f7fafc;    /* æ·ºè‰²æ–‡å­— */
            --card-bg: #2d3748;       /* å¡ç‰‡èƒŒæ™¯ */
        }

        body {
            font-family: "å¾®è»Ÿæ­£é»‘é«”", sans-serif;
            background-color: var(--primary-color);
            color: var(--text-color);
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }

        h1 {
            color: var(--accent-color);
            border-bottom: 2px solid var(--accent-color);
            padding-bottom: 10px;
            margin-bottom: 30px;
        }

        /* ä¸Šå‚³å€åŸŸæ¨£å¼ */
        .upload-container {
            background-color: var(--card-bg);
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
            text-align: center;
            width: 100%;
            max-width: 600px;
            margin-bottom: 20px;
            border: 2px dashed #4a5568;
        }

        .upload-container:hover {
            border-color: var(--accent-color);
        }

        input[type="file"] {
            display: none; /* éš±è—åŸå§‹é†œé†œçš„æŒ‰éˆ• */
        }

        .custom-file-upload {
            display: inline-block;
            padding: 12px 24px;
            cursor: pointer;
            background-color: var(--accent-color);
            color: #1a202c;
            border-radius: 5px;
            font-weight: bold;
            transition: all 0.3s;
        }

        .custom-file-upload:hover {
            background-color: #ecc94b;
            transform: translateY(-2px);
        }

        #fileNameDisplay {
            margin-top: 15px;
            font-size: 0.9rem;
            color: #a0aec0;
        }

        /* æ•¸æ“šå±•ç¤ºå€åŸŸ */
        #dataDisplay {
            width: 100%;
            max-width: 1000px;
            background-color: var(--card-bg);
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
            overflow-x: auto; /* è‹¥è¡¨æ ¼å¤ªå¯¬å¯æ²å‹• */
            display: none; /* é è¨­éš±è—ï¼Œæœ‰è³‡æ–™æ‰é¡¯ç¤º */
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
            color: #cbd5e0;
        }

        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #4a5568;
        }

        th {
            background-color: #1a202c;
            color: var(--accent-color);
        }
    </style>
</head>
<body>

    <h1>Rexå¤§å”çš„168å°è‚¡æŠ•è³‡æ•™å®¤</h1>

    <div class="upload-container">
        <label for="excelInput" class="custom-file-upload">
            ğŸ“‚ é»æ“Šä¸Šå‚³æœˆå ±è¡¨ (.xlsx)
        </label>
        <input type="file" id="excelInput" accept=".xlsx, .xls" />
        <div id="fileNameDisplay">å°šæœªé¸æ“‡æª”æ¡ˆ</div>
    </div>

    <div id="dataDisplay">
        <h3 style="color: var(--accent-color);">æ•¸æ“šé è¦½ (è®€å–åˆ°çš„ç¬¬ä¸€å€‹å·¥ä½œè¡¨)</h3>
        <div id="tableContainer"></div>
    </div>

    <script>
        /* --- JavaScript é‚è¼¯å€ --- */

        // 1. ç›£è½æª”æ¡ˆä¸Šå‚³æŒ‰éˆ•
        document.getElementById('excelInput').addEventListener('change', handleFileSelect, false);

        function handleFileSelect(event) {
            const file = event.target.files[0];
            
            // å¦‚æœæ²’æœ‰æª”æ¡ˆå°±è·³å‡º
            if (!file) return;

            // æ›´æ–°ç•«é¢ä¸Šçš„æª”å
            document.getElementById('fileNameDisplay').textContent = `å·²é¸æ“‡: ${file.name}`;

            // 2. é–‹å§‹è®€å– Excel
            const reader = new FileReader();

            // é‡è¦ï¼šExcel å¿…é ˆç”¨ ArrayBuffer è®€å–
            reader.readAsArrayBuffer(file);

            reader.onload = function(e) {
                const data = new Uint8Array(e.target.result);
                
                // ä½¿ç”¨ SheetJS è§£æ Excel
                const workbook = XLSX.read(data, {type: 'array'});

                // å–å¾—ç¬¬ä¸€å€‹å·¥ä½œè¡¨ (Sheet) çš„åç¨±
                const firstSheetName = workbook.SheetNames[0];
                
                // å–å¾—è©²å·¥ä½œè¡¨çš„å…§å®¹
                const worksheet = workbook.Sheets[firstSheetName];

                // å°‡ Excel è³‡æ–™è½‰æˆ JSON (é™£åˆ—æ ¼å¼)ï¼Œæ–¹ä¾¿ç¨‹å¼ä½¿ç”¨
                const jsonData = XLSX.utils.sheet_to_json(worksheet);

                // 3. è™•ç†æ•¸æ“š (é€™è£¡å…ˆåšç°¡å–®çš„è¡¨æ ¼å±•ç¤ºï¼Œè­‰æ˜è®€å–æˆåŠŸ)
                console.log("è®€å–åˆ°çš„ Excel è³‡æ–™:", jsonData);
                renderTable(jsonData);
            };
        }

        // è¼”åŠ©åŠŸèƒ½ï¼šæŠŠè®€åˆ°çš„ JSON è³‡æ–™ç•«æˆè¡¨æ ¼
        function renderTable(data) {
            const displayDiv = document.getElementById('dataDisplay');
            const container = document.getElementById('tableContainer');
            
            if (data.length === 0) {
                container.innerHTML = "<p>æª”æ¡ˆæ˜¯ç©ºçš„æˆ–æ ¼å¼ä¸æ­£ç¢º</p>";
                displayDiv.style.display = 'block';
                return;
            }

            // å»ºç«‹è¡¨æ ¼ HTML
            let tableHtml = '<table><thead><tr>';
            
            // å–å¾—æ¨™é¡Œåˆ— (Excel çš„ç¬¬ä¸€è¡Œ)
            const headers = Object.keys(data[0]);
            headers.forEach(header => {
                tableHtml += `<th>${header}</th>`;
            });
            tableHtml += '</tr></thead><tbody>';

            // å–å¾—å…§å®¹åˆ— (é¡¯ç¤ºå‰ 10 ç­†å°±å¥½ï¼Œé¿å…é é¢å¤ªé•·)
            data.slice(0, 10).forEach(row => {
                tableHtml += '<tr>';
                headers.forEach(header => {
                    // å¦‚æœè©²æ ¼å­æ˜¯ç©ºçš„ï¼Œé¡¯ç¤ºç©ºç™½
                    tableHtml += `<td>${row[header] || ''}</td>`;
                });
                tableHtml += '</tr>';
            });

            tableHtml += '</tbody></table>';
            
            if (data.length > 10) {
                tableHtml += `<p style="text-align:center; color:#a0aec0; margin-top:10px;">(åƒ…é¡¯ç¤ºå‰ 10 ç­†æ•¸æ“šï¼Œå…± ${data.length} ç­†)</p>`;
            }

            // æ’å…¥ç•«é¢ä¸¦é¡¯ç¤º
            container.innerHTML = tableHtml;
            displayDiv.style.display = 'block';
        }
    </script>
</body>
</html>
